{% extends 'base.html' %}

{% block title %}Live Session - E-Learning Platform{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="/static/live_sessions/css/webrtc.css">
{% endblock %}

{% block content %}
<input type="hidden" id="room-name" value="{{ room_name }}">
<input type="hidden" id="user-id" value="{{ user.id }}">
<input type="hidden" id="user-role" value="{{ user.profile.role }}">
<input type="hidden" id="username" value="{{ user.username }}">

<h2 class="mb-4">ğŸ’¬ Live 1-to-1 Doubt Session</h2>

<div class="row">
    <div class="col-md-8">
        <div class="video-container">
            <div class="video-box">
                <video id="localVideo" autoplay muted playsinline></video>
                <div class="video-label">ğŸ“¹ You ({{ user.username }})</div>
            </div>

            <div class="video-box">
                <video id="remoteVideo" autoplay playsinline></video>
                <div class="video-label">ğŸ“¹ Remote Peer</div>
            </div>
        </div>

        <div class="controls text-center mt-3">
            <button id="startButton" class="btn btn-success btn-lg">
                ğŸ“ Start Call
            </button>
            <button id="endButton" class="btn btn-danger btn-lg" disabled>
                âŒ End Call
            </button>
        </div>

        <div class="alert alert-warning mt-3">
            <strong>âš ï¸ Note:</strong> Please allow camera and microphone permissions when prompted.
        </div>
    </div>

    <div class="col-md-4">
        <div class="card">
            <div class="card-header bg-primary text-white">
                <h5 class="mb-0">ğŸ’¬ Chat</h5>
            </div>
            <div class="card-body p-0">
                <div class="chat-container" id="chatMessages"></div>
            </div>
            <div class="card-footer">
                <div class="input-group">
                    <input type="text" id="chatInput" class="form-control" placeholder="Type a message..."
                        maxlength="500">
                    <button id="sendButton" class="btn btn-primary">
                        Send
                    </button>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script src="/static/live_sessions/js/webrtc.js"></script>
{% endblock %}